import React, { useState, useRef, useEffect } from "react";
import { BrowserRouter as Router, Routes, Route, Link, useLocation } from "react-router-dom";
// PDF helpers require these packages in your project:
// npm install jspdf html2canvas
import jsPDF from 'jspdf';
import html2canvas from 'html2canvas';

// Single-file React SPA: Sylarx | Baki Mode — 3-Month Discipline Transformation
// Notes: Tailwind classes are used for convenience but not required.

export default function App() {
  return (
    <Router>
      <div className="min-h-screen bg-gradient-to-b from-[#020203] via-[#070707] to-[#0b0d10] text-[#eef6fb] font-sans">
        <div className="flex">
          <Sidebar />
          <main className="flex-1 p-8 md:p-12">
            <div className="mb-6 text-sm text-[#bdbdbd]">Sylarx | Baki Mode — 3-Month Discipline Transformation</div>
            <Routes>
              <Route path="/" element={<Home />} />
              <Route path="/workout" element={<Workout />} />
              <Route path="/diet" element={<Diet />} />
              <Route path="/notes" element={<Notes />} />
              <Route path="/music" element={<Music />} />
            </Routes>
          </main>
        </div>
      </div>
    </Router>
  );
}

function Sidebar() {
  const links = [
    { to: "/", label: "Home" },
    { to: "/workout", label: "Workout Plan" },
    { to: "/diet", label: "Diet Plan" },
    { to: "/notes", label: "Transformation Notes" },
    { to: "/music", label: "Music" }
  ];
  const location = useLocation();

  return (
    <aside className="w-72 fixed left-0 top-0 bottom-0 p-8 bg-gradient-to-b from-[#140606cc] to-[#0a0606e6] border-r border-white/5 shadow-[0_0_40px_rgba(255,77,77,0.12)]">
      <div className="text-2xl font-extrabold text-[#FF4D4D]">Sylarx | Baki Mode</div>
      <div className="text-sm text-[#bdbdbd] mt-2">Intense trainer • Teen-safe hypertrophy</div>

      <nav className="mt-6 flex flex-col gap-3">
        {links.map((l) => (
          <Link
            key={l.to}
            to={l.to}
            className={`text-left px-3 py-2 rounded-md font-semibold border border-white/5 transition-all ${location.pathname === l.to ? 'bg-[#FF4D4D0A] ring-2 ring-[#FF4D4D22] transform -translate-y-0.5' : 'hover:bg-white/2'}`}>
            {l.label}
          </Link>
        ))}
      </nav>

      <div className="mt-auto text-xs text-[#bdbdbd]">
        <div>Gym timing: 5:00 PM — 7:00 PM</div>
        <div className="mt-2">Contact: op840809@gmail.com</div>
      </div>
    </aside>
  );
}

function Card({ children, className = '' }) {
  return (
    <div className={`bg-[rgba(255,255,255,0.02)] border border-white/5 rounded-xl p-6 mb-6 shadow-[0_6px_24px_rgba(0,0,0,0.6)] ${className}`}>
      {children}
    </div>
  );
}

function Home() {
  return (
    <div className="ml-0 md:ml-72">
      <Card>
        <h1 className="text-3xl font-bold">Welcome — Sylarx Baki Mode</h1>
        <p className="text-[#bdbdbd] mt-2">This training hub contains your Workout, Diet and Notes pages. Use the Music page to play local tracks during training.</p>
      </Card>

      <div className="grid md:grid-cols-2 gap-6">
        <Card>
          <h3 className="text-[#FF4D4D]">Quick Start</h3>
          <ul className="mt-3 text-[#bdbdbd] list-disc list-inside">
            <li>Follow consistent training 6 days/week (Push/Pull/Legs split).</li>
            <li>Hit protein target ~1.6–2 g/kg bodyweight (110–140 g/day approx.).</li>
            <li>Sleep 7–8 hours nightly. Hydrate 3–3.5 L/day.</li>
          </ul>
        </Card>

        <Card className="flex flex-col items-center justify-center">
          <div className="w-14 h-14 rounded-full bg-gradient-to-b from-[#FF4D4D22] to-[#FF4D4D0F] flex items-center justify-center shadow-[0_6px_28px_rgba(255,77,77,0.06)]">
            <div className="w-3 h-3 rounded-full bg-[#FF4D4D] animate-pulse" />
          </div>
          <div className="text-sm text-[#bdbdbd] mt-2">Aura: Neon Red</div>
        </Card>
      </div>
    </div>
  );
}

function Workout() {
  return (
    <div className="ml-0 md:ml-72">
      <Card>
        <h2 className="text-2xl font-bold">Transformation Workout — Winter Edition (3 Phases)</h2>
        <p className="text-[#bdbdbd] mt-2">You train 6 days/week. Focus on progressive overload and clean form (you already know form — increase loads gradually).</p>
      </Card>

      <Card id="workout-checklist-dark">
        <h3 className="text-[#FF4D4D]">Phase 1 — Foundation (Dec–Feb)</h3>
        <pre className="workout whitespace-pre-wrap text-sm mt-3 text-[#eef6fb]">{`Structure: 6 days (Push / Pull / Legs) — moderate volume, learn tempo and control.

MON – Push (Chest, Shoulders, Triceps)
- Barbell Bench Press 4×6–8
- Incline Dumbbell Press 3×8–10
- Overhead Press 3×8–10
- Dumbbell Lateral Raise 3×12–15
- Triceps Pushdown 3×10–12
- Hanging Leg Raise 3×12–15

TUE – Pull (Back, Biceps)
- Pull-ups 4×max
- Barbell Row 3×6–8
- Seated Cable Row 3×10–12
- Face Pulls 3×12–15
- Dumbbell Curls 3×10–12
- Plank 3×60s

WED – Legs (Quads focus)
- Back Squat 4×6–8
- Romanian Deadlift 3×8–10
- Leg Press 3×10–12
- Walking Lunges 3×12 each
- Standing Calf Raise 4×15–20

THU – Push (variation, slightly lighter)
- Incline DB Press 4×8–10
- Cable Fly 3×12–15
- Arnold Press 3×10–12
- Triceps Dips 3×failure
- Core: Cable Crunch 3×15

FRI – Pull (strength focus)
- Deadlift 4×4–6
- Wide-Grip Lat Pulldown 3×10
- Chest-Supported Row 3×8–10
- Hammer Curls 3×10–12
- Rear Delt Fly 3×12–15

SAT – Legs (Hamstrings & Glutes)
- Romanian Deadlift 4×8–10
- Hip Thrust 4×8–10
- Bulgarian Split Squat 3×12 each
- Seated Calf Raise 4×15
- Mobility & light core work

SUN – Rest / Active recovery
`}</pre>
        <div style={{display:'flex',gap:12,marginTop:12}}>
          <button onClick={() => makeWorkoutChecklistPDF('workout-checklist-dark','workout-dark.pdf','workout-white.pdf')} className="btn">Download Checklists (Dark & White)</button>
        </div>
      </Card>

      <Card>
        <h3 className="text-[#FF4D4D]">Phase 2 — Growth & Volume (Mar–May)</h3>
        <pre className="workout whitespace-pre-wrap text-sm mt-3 text-[#eef6fb]">{`Structure: Increase weekly volume & intensity. Add 1–2 intensity techniques (drop sets, short-rest supersets).
- Train same split but slightly higher reps (8–12) and occasional supersets.
- Add 10–20% calories (clean surplus) and keep protein high.
- Continue creatine + EAA; track weekly measurements.`}</pre>
      </Card>

      <Card>
        <h3 className="text-[#FF4D4D]">Phase 3 — Definition & Refinement (Jun–Aug)</h3>
        <pre className="workout whitespace-pre-wrap text-sm mt-3 text-[#eef6fb]">{`Structure: Preserve muscle, reduce body fat, increase conditioning.
- Slight calorie reduction, add 2 cardio sessions/week (15–25 min incline walk / HIIT).
- Keep strength training 4–5x/week, focus on time under tension and posture.
- Maintain protein, prioritize sleep & recovery.`}</pre>
      </Card>
    </div>
  );
}

function Diet() {
  return (
    <div className="ml-0 md:ml-72">
      <Card id="diet-checklist-dark">
        <h2 className="text-2xl font-bold">Winter Lean Muscle Diet — Eggetarian</h2>
        <p className="text-[#bdbdbd] mt-2">Clean, warm meals suitable for the winter months — keep protein high and include good fats for joint & skin health.</p>

        <div className="grid md:grid-cols-2 gap-6 mt-4">
          <Card>
            <h3 className="text-[#FF4D4D]">Daily Meal Structure</h3>
            <ul className="list-disc list-inside mt-3 text-[#bdbdbd]">
              <li>Morning: Warm water + lemon + 5 soaked almonds + 1 walnut</li>
              <li>Breakfast: Oats 50 g + 1 banana + 1 tbsp peanut butter + 1 scoop pea protein (warm milk)</li>
              <li>Midday snack: 2 boiled eggs or roasted chana</li>
              <li>Lunch: 2 rotis + rice + dal/rajma/chole + paneer/tofu + veggies + 1 tsp ghee</li>
              <li>Pre-workout: Banana + peanut butter + optional black coffee (30–45 min before)</li>
              <li>Post-workout: Pea protein + 3–5 g creatine + quick carbs (banana / brown bread)</li>
              <li>Dinner: Rotis + paneer/tofu/dal + cooked vegetables; warm milk optional before bed</li>
            </ul>
          </Card>

          <Card>
            <h3 className="text-[#FF4D4D]">Supplements & Notes</h3>
            <ul className="list-disc list-inside mt-3 text-[#bdbdbd]">
              <li>Multivitamin: with breakfast (HK Vitals)</li>
              <li>Fish Oil: with lunch (HK Vitals)</li>
              <li>Creatine: 3–5 g daily – mix with post-workout shake</li>
              <li>Pea Protein: post-workout and as needed to hit protein target</li>
              <li>EAA: intra-workout or pre-workout as needed</li>
              <li>Hydration: 3–3.5 L/day; Sleep 7–8 hrs</li>
            </ul>
          </Card>
        </div>

        <div style={{display:'flex',gap:12,marginTop:12}}>
          <button onClick={() => makeDietChecklistPDF('diet-checklist-dark','diet-dark.pdf','diet-white.pdf')} className="btn">Download Diet Checklists (Dark & White)</button>
        </div>
      </Card>

      <Card>
        <h3 className="text-[#FF4D4D]">Weekend Meal Prep Tips</h3>
        <ol className="list-decimal list-inside mt-3 text-[#bdbdbd]">
          <li>Boil 6–8 eggs and store for 3–4 days.</li>
          <li>Cook dal/rajma/chole in bulk and refrigerate.</li>
          <li>Cut paneer/tofu into cubes and store ready-to-use.</li>
          <li>Roast peanuts/chana for snacks.</li>
        </ol>
      </Card>
    </div>
  );
}

function Notes() {
  return (
    <div className="ml-0 md:ml-72">
      <Card>
        <h2 className="text-2xl font-bold">Transformation Notes</h2>
        <p className="text-[#bdbdbd] mt-2">Key rules, tracking and mindset for your 6–9 month transformation.</p>
      </Card>

      <div className="grid md:grid-cols-2 gap-6">
        <Card>
          <h3 className="text-[#FF4D4D]">Key Rules</h3>
          <ul className="list-disc list-inside mt-3 text-[#bdbdbd]">
            <li>Discipline &gt; Motivation — follow plan consistently.</li>
            <li>Track photos every 2 weeks and measurements monthly.</li>
            <li>Aim for 1.6–2 g protein/kg/day.</li>
            <li>Limit junk food — 90% clean, 1 cheat meal/week.</li>
          </ul>
        </Card>

        <Card>
          <h3 className="text-[#FF4D4D]">Recovery & Mindset</h3>
          <ul className="list-disc list-inside mt-3 text-[#bdbdbd]">
            <li>Sleep 7–8 hours nightly; deep sleep helps growth.</li>
            <li>Hydrate 3–3.5 L/day even during winter.</li>
            <li>Deload every 6–8 weeks if feeling overtrained.</li>
            <li>Small weekly gains compound into big results over months.</li>
          </ul>
        </Card>
      </div>
    </div>
  );
}

// ------------------ PDF CHECKLIST HELPERS ------------------
// Uses jsPDF + html2canvas. These functions are simple helpers that clone the DOM
// node and produce two PDFs: dark (site look) and white (print-friendly).

function downloadPDF(element, filename){
  return html2canvas(element, {scale:2, useCORS:true}).then(canvas => {
    const imgData = canvas.toDataURL('image/png');
    const pdf = new jsPDF('p', 'mm', 'a4');
    const imgProps = pdf.getImageProperties(imgData);
    const pdfWidth = pdf.internal.pageSize.getWidth();
    const pdfHeight = (imgProps.height * pdfWidth) / imgProps.width;
    pdf.addImage(imgData, 'PNG', 0, 0, pdfWidth, pdfHeight);
    pdf.save(filename);
  });
}

function makeWorkoutChecklistPDF(workoutHtmlId, filenameDark, filenameWhite){
  const el = document.getElementById(workoutHtmlId);
  if(!el) return Promise.reject(new Error('Workout element not found'));
  // dark version
  return downloadPDF(el, filenameDark).then(()=>{
    // white version: clone & restyle
    const clone = el.cloneNode(true);
    clone.style.background = '#ffffff';
    clone.querySelectorAll('*').forEach(n => n.style.color = '#000000');
    clone.style.padding = '24px';
    clone.style.width = '794px';
    clone.style.boxSizing = 'border-box';
    document.body.appendChild(clone);
    return downloadPDF(clone, filenameWhite).then(()=>{ document.body.removeChild(clone); });
  });
}

function makeDietChecklistPDF(dietHtmlId, filenameDark, filenameWhite){
  return makeWorkoutChecklistPDF(dietHtmlId, filenameDark, filenameWhite);
}

export { makeWorkoutChecklistPDF, makeDietChecklistPDF };
